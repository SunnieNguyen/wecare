(()=>{"use strict";const{__:t}=wp.i18n;function e(t,e,r,o,n,i,l,d,u,y,v,c){e=parseFloat(e),o=yasrTrueFalseStringConvertion(o);const m=document.getElementById(n);s(v,!1),yasrSetRaterValue(t,n,m,1,o,e,(function(t,e){s(v,!0);const o={action:"yasr_send_visitor_rating",rating:t,post_id:r,nonce_visitor:l,is_singular:d};this.setRating(t),this.disable(),jQuery.post(yasrCommonData.ajaxurl,o).done((function(t){if(!1===(t=yasrValidJson(t)))return s(v,!1),void a(c,"<span>Not a valid Json Element, rating can't be saved.</span>");let r,o=`yasr-vote-${t.status}`;"success"===t.status&&(a(u,t.number_of_votes),a(y,t.average_rating)),r=`<span class="yasr-small-block-bold" id="${o}"> ${t.text} </span>`,a(c,r),s(v,!1),e()})).fail((function(t,e,a,s){console.error("YASR ajax call failed. Can't save data"),console.log(t)}))}))}function a(t,e){null!==t&&(t.innerHTML=e,t.style.display="")}function s(t,e=!0){let s="";!0===e&&(s=yasrCommonData.loaderHtml),a(t,s)}function r(e){const a=e.medium_rating;delete e.medium_rating;let s=0;for(let t=1;t<=5;t++)(1===t||e[t].n_of_votes>s)&&(s=e[t].n_of_votes);let r=Math.log(s)*Math.LOG10E+1|0,o="5%";r<=3&&(o="5%"),r>3&&r<=5&&(o="10%"),r>5&&(o="15%");let n='<div class="yasr-visitors-stats-tooltip">';n+='<span id="yasr-medium-rating-tooltip">'+a+" "+t("out of 5 stars","yet-another-stars-rating")+"</span>",n+='<div class="yasr-progress-bars-container">';let i=t("stars","yet-another-stars-rating"),l=0,d=0;for(let a=5;a>0;a--)1===a&&(i=t("star","yet-another-stars-rating")),void 0!==e[a]&&(l=e[a].progressbar,d=e[a].n_of_votes),n+=`<div class='yasr-progress-bar-row-container yasr-w3-container'>\n                               <div class='yasr-progress-bar-name'>${a} ${i}</div> \n                               <div class='yasr-single-progress-bar-container'> \n                                   <div class='yasr-w3-border'> \n                                       <div class='yasr-w3-amber' style='height:17px;width:${l}'></div> \n                                   </div>\n                               </div> \n                               <div class='yasr-progress-bar-votes-count' style="flex-basis:${o} ">${d}</div>\n                           </div>`;return n+="</div></div>",n}!function(t){if(t.length>0&&(function(t){for(let r=0;r<t.length;r++)!function(r){if(!1!==t.item(r).classList.contains("yasr-star-rating"))return;const o=t.item(r),n=o.getAttribute("data-rater-postid"),i=o.id,l=i.replace("yasr-visitor-votes-rater-",""),d=document.getElementById("yasr_visitor_votes_"+l),u=parseInt(o.getAttribute("data-rater-starsize")),y=o.getAttribute("data-rater-nonce"),v=o.getAttribute("data-issingular"),c="yasr-vv-votes-number-container-"+l,m="yasr-vv-average-container-"+l,g="yasr-vv-bottom-container-"+l,_="yasr-vv-loader-"+l,f=document.getElementById(c),p=document.getElementById(m),b=document.getElementById(g),h=document.getElementById(_);let C=o.getAttribute("data-rating"),E=o.getAttribute("data-readonly-attribute"),x=o.getAttribute("data-rater-readonly");if(null===E&&(E=!1),E=yasrTrueFalseStringConvertion(E),x=yasrTrueFalseStringConvertion(x),!0===E&&(x=!0),"yes"===yasrCommonData.ajaxEnabled){s(h);let t={action:"yasr_load_vv",post_id:n};jQuery.get(yasrCommonData.ajaxurl,t).done((function(t){let r,o=yasrValidJson(t);if(!1===o){let t="Not a valid Json Element";return s(h,!1),void a(d,t)}if(r=!0===E||o.yasr_visitor_votes.stars_attributes.read_only,C=o.yasr_visitor_votes.number_of_votes>0?o.yasr_visitor_votes.sum_votes/o.yasr_visitor_votes.number_of_votes:0,C=C.toFixed(1),C=parseFloat(C),e(u,C,n,r,i,0,y,v,f,p,h,b),!0!==E&&(a(f,o.yasr_visitor_votes.number_of_votes),a(p,C),!1!==o.yasr_visitor_votes.stars_attributes.span_bottom)){let t=o.yasr_visitor_votes.stars_attributes.span_bottom;a(b,t)}})).fail((function(t,a,s,r){console.info("YASR ajax call failed. Showing ratings from html"),e(u,C,n,x,i,0,y,v,f,p,h,b),!0!==E&&(b.style.display="")}))}else e(u,C,n,x,i,0,y,v,f,p,h,b)}(r)}(t),"yes"===yasrCommonData.visitorStatsEnabled)){let t=document.getElementsByClassName("yasr-dashicons-visitor-stats");t&&function(t){let e,a,s=!1;for(let o=0;o<t.length;o++)!function(o){let n="#"+t.item(o).id,i=t.item(o).getAttribute("data-postid");0===o&&(e=document.getElementsByClassName("yasr-vv-text-container"),null!==e&&(a=window.getComputedStyle(e[0],null).getPropertyValue("color"))),a&&(document.getElementById(t.item(o).id).style.fill=a);let l={action:"yasr_stats_visitors_votes",post_id:i};"function"==typeof tippy&&tippy(n,{allowHTML:!0,content:'<span style="color: #0a0a0a">Loading...</span>',theme:"yasr",arrow:!0,arrowType:"round",onShow:function(t){n!==s&&jQuery.post(yasrCommonData.ajaxurl,l,(function(e){if(!1!==(e=yasrValidJson(e)))return"error"===e.status?(console.error(e.text),void t.setContent(e.text)):void t.setContent(r(e));t.setContent("Error!")})).fail((function(e,a,s,r){console.log(e),t.setContent("YASR ajax call failed.")}))},onHidden:function(){s=n}})}(o)}(t)}}(document.getElementsByClassName("yasr-rater-stars-vv"))})();